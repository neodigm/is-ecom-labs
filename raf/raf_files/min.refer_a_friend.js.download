var form_state={ss_your_email:"",ss_your_name:"",ss_existing_emails:[],doc_ready:false,show_form:function(a){$(".spinner").addClass("hidden");$("#state-sec__form").removeClass("state_sec__blur");if(a==="form"){formEvents()}$(".state-sec").addClass("hidden");$("#state-sec__"+a).removeClass("hidden")},clickable:function(a,b){(b)?$("#"+a).removeClass("cmd_disabled"):$("#"+a).addClass("cmd_disabled")},showError:function(c,b){var d=$("#"+c),a=$("#"+b);if(d&&a){a.css("width",d.css("width")).removeClass("resp_error_vis__hide");return true}}};function formEvents(){$("#state-sec__form").find("*").each(function(){$(this).off()});componentHandler.upgradeDom();$(".mdl-ltd--input").focusin(function(a){$(this).toggleClass("mdl-ltd--input__static");$(this).siblings("label").toggleClass("mdl-ltd--label__focusin").toggleClass("mdl-ltd--label__focusout")});$(".mdl-ltd--input").focusout(function(a){$(this).siblings("label").toggleClass("mdl-ltd--label__focusin").toggleClass("mdl-ltd--label__focusout");$(this).toggleClass("mdl-ltd--input__static")});$("#rafSubmit").hover(function(){if($(this).hasClass("cmd_disabled")){$("#error_rafSubmit").text(errorMsgText("rafForm")[1]);form_state.showError("rafSubmit","error_rafSubmit")}},function(){if($(this).hasClass("cmd_disabled")){$("#error_rafSubmit").addClass("resp_error_vis__hide")}});$("#rafSubmit").on("click",function(){if($(this).hasClass("cmd_disabled")){$("#error_rafSubmit").text(errorMsgText("rafForm")[1]);form_state.showError("rafSubmit","error_rafSubmit")}});$(".js-alpha-only").on("keyup",function(a){var b=a.keyCode||a.which;if((b>47)&&(b<58)){this.value=this.value.replace(/[0-9]/g,"")}});$("#currentCharacterNumber").html($("#rafComment").text().length);$("#rafComment").on("keyup keydown",function(){limitCharacterNumber(this,350,"currentCharacterNumber")});$("#rafForm").on("submit",function(d){d.preventDefault();if(!$("#rafSubmit").hasClass("cmd_disabled")){if(!$("#rafSubmit").hasClass("cmd_locked")){$("#encodedReferralIDParameter").val($(encodedURL).attr("href"));$("#rafSubmit").addClass("cmd_locked");var b=$("#rafForm");var c=$(b),a={beforeSerialize:function(f,e){$("<input />",{name:"/ltd/myAccount/refer/LTDReferAFriendFormHandler.referAFriend",value:"Submit",type:"hidden"}).add($("<input />",{name:"/ltd/myAccount/refer/LTDReferAFriendFormHandler.referAFriend.x",value:"1",type:"hidden"})).add($("<input />",{name:"/ltd/myAccount/refer/LTDReferAFriendFormHandler.referAFriend.y",value:"1",type:"hidden"})).appendTo(f)},url:CONTEXT_ROOT+"my_account/refer/friend_container.jsp",success:function(g){var e=g.split(",");if(typeof e!=="undefined"&&e.length==2&&e[0]=="session_expired"){var f=e[1];window.location=f}else{$("div.raf_right_col").html(g)}},beforeSend:function(){$(".spinner").removeClass("hidden");$("#state-sec__form").addClass("state_sec__blur")},complete:function(){addAndroidMaxLength();fireTealiumEvent({e_refer_a_friend:"t"})}};if(c.length>0){c.ajaxSubmit(a)}}}});$(".js-success--a__form").on("click",function(a){$("div.raf_right_col").load(CONTEXT_ROOT+"my_account/refer/friend_container.jsp?ts="+(new Date()).getTime(),function(){});$(".raf_left_col").show();a.preventDefault()});$(".js-success--a__continue").on("click",function(a){document.location.href="/";a.preventDefault()});addAndroidMaxLength()}$(document).ready(function(){docEventReady()});function docEventReady(){if(!form_state.doc_ready){form_state.doc_ready=true;$(document).on("keyup click",function(){if($("#rafForm").length!==0){var a=errorMsgText("rafForm");$("#error_rafSubmit").text(a[1]);form_state.clickable("rafSubmit",isOk("rafForm"))}});formEvents();form_state.ss_your_email=$(".js-ss-your-email").text().toLowerCase().trim()}}function isOk(b){var a=true;switch(b){case"rafForm":a=(errorMsgText(b)[1]==="")?true:false;break}return a}function errorMsgText(d){var c=0,b="";switch(d){case"rafForm":var a=["","Please enter your friend's name.","Please enter your friend's email address.","Please enter a valid email address.","Your friend's email address cannot be your email address.","Please enter your name.","Please enter a message to your friend","You have already entered this email address."];if($("#rafYourName").val()===""){c=5}else{if($("#rafFriendsEmail").val()===""){c=2}else{if($("#rafFriendsEmail").val().indexOf("@")===-1){c=3}else{if($("#rafFriendsEmail").val().indexOf(".")===-1){c=3}else{if($("#rafFriendsEmail").val().toLowerCase().trim()===form_state.ss_your_email.toLowerCase().trim()){c=4}else{if($("#rafFriendsName").val()===""){c=1}else{if($("#rafComment").val()===""){c=6}else{if(form_state.ss_existing_emails.indexOf($("#rafFriendsEmail").val().toUpperCase())!==-1){c=7}}}}}}}}b=a[c];break}return[c,b]};