function js_currency_only(c,d){var e=[0,1,2,3,4,5,6,7,8,99,118,120];var b=d.which,a=(c.value.indexOf(".")===-1);e=(d.ctrlKey)?e:e.splice(0,e.length-3);return(e.indexOf(b)!=-1)||((b>=48)&&(b<=57))||(b==46&&a)}function js_number_only(b,c){var d=[0,1,2,3,4,5,6,7,8,99,118,120];var a=c.which,e=($(b).val().length>=$(b).attr("maxlength"));d=(c.ctrlKey)?d:d.splice(0,d.length-3);return(d.indexOf(a)!=-1)||((a>=48)&&(a<=57))&&(!e)}function createEvents_ach_details(){$("#routingNumber").on("keyup",function(){if($(this).val().length>7){a()}else{$("#routingNumber").removeClass("error");$("#resp_bank_name").removeClass().addClass("resp_qtr_height").html(" ")}});$("#routingNumber").on("blur",function(){a()});function a(){var b=($("#routingNumber").val()).trim();if(b.length>0){$.ajax({type:"get",url:"/my_account/invoice/includes/lookup_bank_name.jsp?routingNumber="+b,cache:false,dataType:"html",success:function(e){var c=e.split(",");if(typeof c!=="undefined"&&c.length==2&&c[0]=="session_expired"){var d=c[1];window.location=d}else{$("#routingNumber").addClass("error");if(e.length>0&&e.indexOf("Invalid Bank")!=-1){$("#resp_bank_name").removeClass().addClass("resp_error").html(e)}else{$("#resp_bank_name").removeClass().addClass("resp_valid").html(e);document.addAccountForm.bankName.value=e}$("#error_select_invoice_new").text(errorMsgText(form_state.pio_page));form_state.clickable("continue-w-pay",isOk(form_state.pio_page,form_state.form_flow))}}})}else{$("#routingNumber").removeClass("error");$("#resp_bank_name").removeClass().addClass("resp_qtr_height").html(" ")}}$("#continue-w-pay").on("click",function(){if(!$(this).hasClass("cmd_disabled")){var d=$(this).attr("data-cont-ach-details");var e=d.split("|");var c=$("#"+e[0]);var f=e[1].trim();if(f=="undefined"||f.length<1){var b=$("#yes-no").prop("checked");$("#save-chk-box").val(b)}c.submit()}});$("#editACHDetails").on("click",function(){var c=$(this).attr("data-edit-ach-details");var d=c.split("|");var b=$("#"+d[0]);$("#continue-w-pay").text("Save and Continue");form_state.clickable("continue-w-pay",false);$("#edit-cancel-btn").removeClass("hidden");$("#form-flow-display").removeClass("form-flow-active").addClass("form-flow-inactive");$("#form-flow-new").removeClass("form-flow-inactive").addClass("form-flow-active");b[0].accountHolderName.value=d[1];b[0].routingNumber.value=d[2];b[0].nickName.value=d[3];b[0].bankName.value=d[4];b[0].editFlag.value=Boolean(true);b[0].checkingAccount.value=null;b[0].checkingAccountRe.value=null;$("#would-you-like").addClass("hidden");form_state.form_flow="edit";$("#routingNumber").blur()});$("#cancelACHChanges").on("click",function(){$.get("/my_account/invoice/includes/inc_payment_form.jsp",function(d){var b=d.split(",");if(typeof b!=="undefined"&&b.length==2&&b[0]=="session_expired"){var c=b[1];window.location=c}else{$("#ACHpaymentForm").html(d)}})});$("#deleteACHDetails").on("click",function(){var d=$(this).attr("data-del-ach-details");var c=$("#"+d);$("#del-confirm-dialog").foundation("reveal","close");var e=$(c),b={beforeSerialize:function(g,f){$("<input />",{name:"/ltd/myAccount/invoice/InvoiceFormHandler.RemoveBankAccount",value:"Submit",type:"hidden"}).add($("<input />",{name:"/ltd/myAccount/invoice/InvoiceFormHandler.RemoveBankAccount.x",value:"1",type:"hidden"})).add($("<input />",{name:"/ltd/myAccount/invoice/InvoiceFormHandler.RemoveBankAccount.y",value:"1",type:"hidden"})).appendTo(g)},url:CONTEXT_ROOT+"my_account/invoice/includes/inc_payment_form.jsp",success:function(h){var f=h.split(",");if(typeof f!=="undefined"&&f.length==2&&f[0]=="session_expired"){var g=f[1];window.location=g}else{$("#ACHpaymentForm").html(h);form_state.form_flow="new"}},beforeSend:displayWaitImage,complete:function(){$.unblockUI();addAndroidMaxLength()}};if(e.length>0){e.ajaxSubmit(b)}});$(".js-del-confirm-cancel").on("click",function(){$("#del-confirm-dialog").foundation("reveal","close")});$("#routingNumber").blur();$("#continue-w-pay").hover(function(){if($(this).hasClass("cmd_disabled")){$("#error_select_invoice_new").text(errorMsgText(form_state.pio_page));form_state.showError("continue-w-pay","error_select_invoice_new")}},function(){if($(this).hasClass("cmd_disabled")){$("#error_select_invoice_new").addClass("hidden")}});$("#continue-w-pay").on("click",function(){if($(this).hasClass("cmd_disabled")){$("#error_select_invoice_new").text(errorMsgText(form_state.pio_page));form_state.showError("continue-w-pay","error_select_invoice_new")}});$(document).on("keyup click",function(){if($("#continue-w-pay").text().indexOf("Save")!=-1){$("#error_select_invoice_new").text(errorMsgText(form_state.pio_page));form_state.clickable("continue-w-pay",isOk(form_state.pio_page,form_state.form_flow))}});$("#saveACHDetails").hover(function(){if($(this).hasClass("cmd_disabled")){$("#error_select_invoice_edit").removeClass("hidden")}},function(){if($(this).hasClass("cmd_disabled")){$("#error_select_invoice_edit").addClass("hidden")}});$("#saveACHDetails").on("click",function(){if($(this).hasClass("cmd_disabled")){$("#error_select_invoice_edit").removeClass("hidden")}});$(".js-number-only").on("keypress",function(b){return js_number_only(this,b)});$(".js-number-only").on("input",function(c){var b=$(this).val();$(this)[0].value="";$(this).val(b.replace(/\./g,"9"))});$(".js-alpha-only").on("keyup",function(b){this.value=this.value.replace(/(?=.)\d*(?:[.,]\d+)?$/g,"")});addAndroidMaxLength()}var nav_home={hasChanged:false,revealCount:0};var more_less={inv_limit_warning:25,inv_limit_init:10,MoL_state:"More",inv_is_limit:false,init:function(c,a,b){this.$aTR=c;this.$cmd_more_less=$("#"+b);this.more_than_limit=a;this.inv_is_limit=(this.$aTR.length>this.inv_limit_init);if(this.inv_is_limit){if(this.$aTR.length===this.inv_limit_warning){$(".js-limit-warning").removeClass("hidden")}this.$cmd_more_less.on("click",function(d){more_less.MoL_state=(more_less.MoL_state==="Less")?"More":"Less";more_less.$cmd_more_less.text(more_less.MoL_state);more_less.showMoreOrLess();d.preventDefault()})}return this.clickable(this.inv_is_limit)},clickable:function(a){(a)?$("."+this.more_than_limit).removeClass("hidden"):$("."+this.more_than_limit).addClass("hidden");return a},showMoreOrLess:function(){var a=0;this.$aTR.each(function(){if(a++>=more_less.inv_limit_init){$(this).toggleClass("hidden")}})}};var form_state={clickable:function(a,b){(b)?$("#"+a).removeClass("cmd_disabled"):$("#"+a).addClass("cmd_disabled");if(b){$("#error_select_invoice").addClass("hidden")}},showError:function(c,b){var d=$("#"+c),a=$("#"+b);if(d&&a){a.css("width",d.css("width")).removeClass("hidden");return true}},pio_page:document.body.getAttribute("data-pio-page"),form_flow:"new"};function calculateTotal(){var a=0;$("#invoicetable tr").filter(":has(:checkbox:checked)").each(function(){var b=this.id;if(b!="js-header"){var d="amt"+b;var c="amtdue"+b;if(!isNaN(parseFloat($("#"+d).val()))){a+=parseFloat($("#"+d).val())}}});$("#invoicePaymentTotalText").html("$"+a.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","))}$(".js-amount").on("input",function(){var a=$(this).parent().parent().attr("id");if($("#checkbox"+a).is(":checked")){if(parseFloat($("#amt"+a).val())>parseFloat($("#amtdue"+a).val())){$("#tr"+a).removeClass("hidden")}else{$("#tr"+a).addClass("hidden")}}calculateTotal()});$(".js-checkbox").click(function(){var a=$(this).parent().parent().attr("id");if($("#"+this.id).is(":checked")){$("#amt"+a).val($("#amtdue"+a).val())}else{$("#amt"+a).val("0.00");$("#selectall").prop("checked",false)}$("#tr"+a).addClass("hidden");calculateTotal()});$(".js-inv-details").click(function(){var d=$(this).attr("data-invoice-details");var a=d.split("|");var c=$("#clickForInvoiceDetailsModal"+a[3]),b=CONTEXT_ROOT+"my_account/invoice/invoice_details.jsp?transactionId="+a[0]+"&amount="+a[1]+"&docDate="+a[2]+"&index="+a[3]+"&sapDoc="+a[4]+"&dueDate="+a[5];c.load(b,function(g,f,i){var e=g.split(",");if(typeof e!=="undefined"&&e.length==2&&e[0]=="session_expired"){var h=e[1];window.location=h}else{$("html, body").scrollTop(0);$("#clickForInvoiceDetailsModal"+a[3]).css("overflow","hidden");$("#clickForInvoiceDetailsModal"+a[3]).foundation("reveal","open");setTimeout(function(){$(document).foundation("equalizer","reflow");$(".invc-det--aside").css("height",($(window).height()-308)+"px")},580)}})});$("#selectall").click(function(){$("#invoicetable tr").each(function(){var a=this.id;$("#tr"+a).addClass("hidden");if(a!="js-header"&&a.indexOf("tr")==-1){var b="checkbox"+a;if($("#selectall").is(":checked")){$("#"+b).prop("checked",true);$("#amt"+a).val($("#amtdue"+a).val())}else{$("#"+b).prop("checked",false);$("#amt"+a).val("0.00")}}});calculateTotal()});function showInvoiceDetails(h,d,g,c,a,b){var f=$("#clickForInvoiceDetailsModal"),e=CONTEXT_ROOT+"my_account/invoice/invoice_details.jsp?transactionId="+h+"&amount="+d+"&docDate="+g+"&index="+c+"&sapDoc="+a+"&dueDate="+b;f.load(e,function(k,j,m){var i=k.split(",");if(typeof i!=="undefined"&&i.length==2&&i[0]=="session_expired"){var l=i[1];window.location=l}else{$("#clickForInvoiceDetailsModal").foundation("reveal","open");setTimeout(function(){$(document).foundation()},600)}})}function updateInvTotlCaption(a){if($("input:checked.js-checkbox").length===$(".js-checkbox").length){$("#"+a).text("Pay All Invoices")}else{$("#"+a).text("Pay Selected Invoices")}}function isOk(d,a){var c=true;switch(d){case"pio_select_invoices":var b=Number($("#invoicePaymentTotalText").text().replace("$",""));b=(b<0);c=(!b)&&($("#invoicePaymentTotalText").text()!=="$0.00")&&($(".resp_error").closest("tr").not(".hidden").length===0);break;case"pio_ach_details":c=($("#accountHolderName").val()!=="")&&($("#routingNumber").val()!=="")&&($("#checkingAccount").val()!=="")&&($("#checkingAccountRe").val()!=="")&&($("#checkingAccount").val()===$("#checkingAccountRe").val())&&($("#resp_bank_name").hasClass("resp_valid"));break;case"pio_agreement":var b=Number($("#invoicePaymentTotalText").text().replace("$",""));b=(b<0);c=(!b)&&($("#invoicePaymentTotalText").text()!=="$0.00")&&($(".resp_error").closest("tr").not(".hidden").length===0)&&($("#chkAgree").prop("checked"));break;case"pio_confirmation":break}return c}function errorMsgText(e,c){var d=0,b="";switch(e){case"pio_select_invoices":var a=["Please Review Information","Please Select an Invoice.","Your Payment Total cannot be 0 or less than 0. Please review.","The amount entered cannot exceed the invoice amount"];if($("input:checked.js-checkbox").length===0){d=1}else{if($("#invoicePaymentTotalText").text()==="$0.00"){d=2}else{if($("#invoicePaymentTotalText").text().indexOf("-")!==-1){d=2}else{if($(".resp_error").closest("tr").not(".hidden").length!==0){d=3}}}}b=a[d];break;case"pio_ach_details":var a=["Please Review Information","All Information is Required","Enter a Valid Routing Number","Checking Account Numbers Must Match","Enter Required Information then click Save"];if(($("#accountHolderName").val()==="")||($("#routingNumber").val()==="")||($("#checkingAccount").val()==="")||($("#checkingAccountRe").val()==="")){d=1}else{if($("#resp_bank_name").hasClass("resp_error")){d=2}else{if($("#checkingAccount").val()!==$("#checkingAccountRe").val()){d=3}}}b=a[d];break;case"pio_agreement":var a=["Please Review Information","Please Select an Invoice.","Your Payment Total cannot be 0 or less than 0. Please review.","The amount entered cannot exceed the invoice amount","Check I Agree above"];if($("input:checked.js-checkbox").length===0){d=1}else{if($("#invoicePaymentTotalText").text()==="$0.00"){d=2}else{if($("#invoicePaymentTotalText").text().indexOf("-")!==-1){d=2}else{if($(".resp_error").closest("tr").not(".hidden").length!==0){d=3}else{if(!$("#chkAgree").prop("checked")){d=4}}}}}b=a[d];break}return b}function uncheckIf0(b,c,a){b.each(function(){var d=c.filter("[id='"+$(this).attr("data-checkbox-id")+"']");if(Number($(this).val())===0&&d.prop("checked")){d.prop("checked",false);return false}if(Number($(this).val())!==0&&!d.prop("checked")){if($(this).attr("id")===a){d.prop("checked",true);return false}}})}$(document).ready(function(){form_state.form_flow="new";form_state.js_amount=$(".js-amount");form_state.js_checkbox=$(".js-checkbox");$(document).foundation({equalizer:{equalize_on_stack:false,act_on_hidden_el:true}});if(form_state.js_amount.length>0){$(".js-amount").on("keyup",function(a){uncheckIf0(form_state.js_amount,form_state.js_checkbox,a.target.id);calculateTotal()})}$(".button").on("click",function(a){if($(this).hasClass("cmd_disabled")){a.preventDefault()}});if(form_state.pio_page==="pio_select_invoices"){calculateTotal();if(!IsSmall()){$("#ccp-1").addClass("ccp-panel__active").find("i").text("-");$("#resp_ccp_1_v").removeClass("hidden")}more_less.init($(".js-more-less"),"js-more-than-inv-limit","cmd-more-less");$(document).on("keyup click",function(){var a=errorMsgText(form_state.pio_page);$("#error_select_invoice").text(a);form_state.clickable("Continue2",isOk(form_state.pio_page,""))});$(".js-currency-only").on("keypress",function(a){return js_currency_only(this,a)});$("#Continue2").hover(function(){if($(this).hasClass("cmd_disabled")){$("#error_select_invoice").text(errorMsgText(form_state.pio_page));$("#error_select_invoice").removeClass("hidden")}},function(){if($(this).hasClass("cmd_disabled")){$("#error_select_invoice").addClass("hidden")}});$("#Continue2").on("click",function(){if($(this).hasClass("cmd_disabled")){$("#error_select_invoice").text(errorMsgText(form_state.pio_page));$("#error_select_invoice").removeClass("hidden")}});$(document).on("opened.fndtn.reveal","[data-reveal]",function(){nav_home.revealCount++})}if(form_state.pio_page==="pio_agreement"){more_less.init($(".js-more-less"),"js-more-than-inv-limit","cmd-more-less");$("#Continue2").hover(function(){if($(this).hasClass("cmd_disabled")){$("#error_agreement").text(errorMsgText(form_state.pio_page));form_state.showError("Continue2","error_agreement")}},function(){if($(this).hasClass("cmd_disabled")){$("#error_agreement").addClass("hidden")}});$("#Continue2").on("click",function(){if($(this).hasClass("cmd_disabled")){$("#error_agreement").text(errorMsgText(form_state.pio_page));form_state.showError("Continue2","error_agreement")}});$(document).on("keyup click",function(){var a=errorMsgText(form_state.pio_page);$("#error_agreement").text(a);form_state.clickable("Continue2",isOk(form_state.pio_page,""))});$(".js-currency-only").on("keypress",function(a){return js_currency_only(this,a)})}if(form_state.pio_page==="pio_ach_details"){createEvents_ach_details()}if(form_state.pio_page==="pio_confirmation"){$("[href='#modalTermsConditions']").parent().addClass("resp_no_print");$(".prime-banner--section").addClass("resp_no_print");$("#a-print").on("click",function(){window.print()})}$(document).on("change",function(){updateInvTotlCaption("invoice-totl--li")});$(document).on("keypress",function(){nav_home.hasChanged=true});$(".js-checkbox").on("click",function(){nav_home.hasChanged=true});$("#branding").addClass("js-nav-home");$(".js-nav-home").on("click",function(a){if(nav_home.hasChanged){$("#nav-home-dialog").foundation("reveal","open");$(".js-nav-home-leave").attr("href",a.target.href);a.preventDefault()}});$(".js-nav-home-stay").on("click",function(){$("#nav-home-dialog").foundation("reveal","close")});$(".js-nav-breadc").on("click",function(a){if($(this).hasClass("unavailable")||$(this).hasClass("current")){a.preventDefault()}});$(".js-ccp").on("click",function(a){$(this).toggleClass("ccp-panel__active").next().toggleClass("hidden");$(this).find("i").text(($(this).hasClass("ccp-panel__active"))?"-":"+")})});function displayWaitImage(){var a=CONTEXT_ROOT+"media/ltd/images/popups/spinner1-black.gif";$.blockUI({message:'<img src="'+a+'" />',css:{top:($(window).height()-100)/2+"px",left:($(window).width()-100)/2+"px",width:"100px",border:"none"}})};